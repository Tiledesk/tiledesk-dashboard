
<!-- <div class="navbar-brand" style="z-index: 1050;position: relative;padding-left:30px"
    [ngStyle]="{'margin-top':isChromeVerGreaterThan100 === true ? '-64px' : '6px' }">
    <i class="material-icons" style="vertical-align: middle !important; cursor: pointer;"
        (click)="goBack()">keyboard_arrow_left</i>
    {{ "UserProfile.Profile" | translate }}
</div> -->

<ul class="bottom-nav" style="top: 61px;">
    <li class="btn-with-border-effect li-active">
        <a> {{ "UserProfile.Profile" | translate }} </a>
    </li>
    <li *ngIf="displayChangePwd" class="btn-with-border-effect border-from-center" (click)="goToChangePsw()">
        <a>{{ "UserProfile.ChangePsw" | translate }} </a>
    </li>
    <li class="btn-with-border-effect border-from-center" (click)="goToAccountSettings()">
        <a>{{ "Settings" | translate }} </a>
    </li>
    <li class="btn-with-border-effect border-from-center" (click)="goToNotificationSettings()">
        <a>{{ "Notification" | translate }} </a>
    </li>
</ul>

<div class="main-content" style="padding-top:0px; margin-top: 95px;">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card card--no-border" style="padding-top: 0px;padding-bottom: 25px; ">
                    
                    <loading-spinner *ngIf="showSpinner"></loading-spinner>

                    <!-- style="border-top:1px solid #eee" -->
                    <div *ngIf="!showSpinner" class="card-content">

                        <div class="row">
                            <div class="col-md-12">
                                <h3 class="card_title__underlined">
                                    <span class="card_title__underline">
                                        {{ "UserProfile.YourDetails" | translate }}
                                    </span>
                                </h3>
                            </div>
                            <div class="col-md-12">
                                <div class="section-subtitle" style="width: calc((100% / 3) + 372px);"> </div>
                            </div>
                        </div>

                        <div class="row">
                            <label class="col-sm-2 avatar_label">
                                Avatar
                            </label>
                            <div class="col-sm-10">
                                <div class="card-avatar">

                                    <img *ngIf="userProfileImageExist === true || userImageHasBeenUploaded === true"
                                        class="user-img user-profile-image" [src]="getUserProfileImage()"
                                        onerror="this.src='assets/img/no_image_user.png'" />

                                    <!-- <p>userProfileImageExist > {{ userProfileImageExist }}  </p>  
                                       <p>userImageHasBeenUploaded > {{ userImageHasBeenUploaded}} </p>  
                                       <p> fullname_initial > {{ user?.fullname_initial }} </p>  
                                       <p>user_fillColour > {{user?.fillColour}} </p>   -->
                                    <div class="user-img user-profile-image"
                                        *ngIf="userProfileImageExist === false && userImageHasBeenUploaded !== true"
                                        [ngStyle]="{'background':  'linear-gradient(rgb(255,255,255) -125%,' + user?.fillColour + ')'}">
                                        <span id="user-profile-altenative-user-avatar"
                                            class="user-profile-altenative-user-avatar">
                                            {{ user?.fullname_initial }}
                                        </span>
                                    </div>

                                    <!-- <img *ngIf="userProfileImageExist === false && userImageHasBeenUploaded !== true"
                                        class="user-img user-profile-image" src="assets/img/no_image_user.png" /> -->



                                    <input #fileInputUserProfileImage class="inputfile" name="teammate-image-profile"
                                        id="teammate-image-profile" type="file" (change)="upload($event)"
                                        [accept]="fileUploadAccept" />
                                   
                                    <label class="btn btn-tdblu-no-boxshadow " for="teammate-image-profile"
                                        style="padding-left:15px; padding-right:15px; text-transform: none; color: #7695a5">
                                        <span *ngIf="!showSpinnerInUploadImageBtn">
                                            {{ "UserProfile.UploadImage" | translate }}
                                        </span>
                                        <span *ngIf="showSpinnerInUploadImageBtn">
                                            {{ 'VisitorsPage.Loading' | translate }}
                                            <i class="fa fa-spinner fa-spin"></i>
                                        </span>
                                    </label>

                                    <button class="btn btn-round-red delete-user-image-btn"
                                        (click)="deleteUserProfileImage()">

                                        <span>
                                            <svg xmlns="http://www.w3.org/2000/svg" height="24px"
                                                viewBox="0 -960 960 960" width="24px" fill="none">
                                                <path
                                                    d="m376-300 104-104 104 104 56-56-104-104 104-104-56-56-104 104-104-104-56 56 104 104-104 104 56 56Zm-96 180q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520Zm-400 0v520-520Z" />
                                            </svg>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <label class="col-sm-2">

                            </label>
                            <div class="col-sm-10" style="margin-bottom: 12px;">
                                <div class="upload-user-photo-tips">
                                    {{ "UserProfile.AddYourOwnPicture" | translate }}
                                </div>
                                <div class="upload-user-photo-tips">
                                    {{ "UserProfile.PreferredSize" | translate }}
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <label class="col-sm-2 custom-label">
                                {{ "UserProfile.Name" | translate }}
                            </label>
                            <div class="col-sm-10">
                                <input (input)="onEditFirstname($event.target.value)" [(ngModel)]="userFirstname"
                                    class="user-firstname" type="text"
                                    placeholder='{{ "UserProfile.Name" | translate }}'>
                            </div>

                            <label class="col-sm-2 custom-label">
                                {{ "UserProfile.Lastname" | translate }}
                            </label>
                            <div class="col-sm-10">
                                <input (input)="onEditLastname($event.target.value)" [(ngModel)]="userLastname" class=""
                                    type="text" placeholder='{{ "UserProfile.Lastname" | translate }}'>
                            </div>
                        </div>

                        <div class="row">
                            <label class="col-sm-2 custom-label">
                                Email
                            </label>
                            <div class="col-sm-10">
                                <input style="color:#808080" [(ngModel)]="user.email" class="" type="text"
                                    placeholder="Email"
                                    [ngClass]="{'pending-email-verification' : emailverified === false }" disabled>
                            </div>
                        </div>

                        <div class="row">
                            <label class="col-sm-2 custom-label">
                                {{ 'UsersPage.Role' | translate }}
                            </label>
                            <div class="col-sm-10">
                                <input style="color:#808080" [(ngModel)]="userRole" class="" type="text"
                                    placeholder="{{ 'UsersPage.Role' | translate }}" disabled>
                            </div>
                        </div>

                        <div class="row">
                            <label class="col-sm-2 custom-label">

                                {{ "UserProfile.UserId" | translate }}
                            </label>
                            <div class="col-sm-10">
                                <input style="color: #808080" [(ngModel)]="user._id" class="" type="text"
                                    placeholder='{{ "UserProfile.UserId" | translate }}' disabled>
                            </div>
                        </div>
                        <div class="row" *ngIf="emailverified == false">
                            <label class="col-sm-2"></label>
                            <div class="col-sm-10">
                                <i class="material-icons"
                                    style="vertical-align: middle; color:#f44336;">error_outline</i>
                                <span style="vertical-align: middle; color:#f44336; font-size: 14px;">
                                    
                                    {{ "UserProfile.YourAccountIsPending" | translate }}

                                </span>
                                <span style="display: block; margin-left: 28px;">
                                    <a (click)="resendVerificationEmail()" class="resend-verification-email">
                                        {{ "UserProfile.ClickHereToResend" | translate }}
                                    </a>
                                </span>
                            </div>
                        </div>

                        <!-- SPACER -->
                        <div class="col-12 spacer" style="height:15px"></div>

                        <div class="row">
                            <label class="col-sm-2"></label>
                            <div class="col-sm-10 ">
                                <!-- btn-primary -->
                                <button class="btn btn-tdblu-no-boxshadow"
                                    (click)="updateCurrentUserFirstnameLastname()"
                                    [disabled]="!HAS_EDIT_FIRSTNAME && !HAS_EDIT_LASTNAME">
                                    {{ "UserProfile.UpdateProfile" | translate }}
                                </button>
                            </div>
                        </div>


                        <!-- --------------------------------------------------------------- -->
                        <!-- Language Preferences -->
                        <!-- --------------------------------------------------------------- -->
                        <div class="row language">
                            <div class="col-md-12">
                                <h3 class="card_title__underlined">
                                    <span class="card_title__underline">
                                        {{ "DashboardLanguage" | translate }}
                                    </span>
                                </h3>
                            </div>
                            <div class="col-md-12">
                                <div class="section-subtitle" style="width: calc((100% / 3) + 372px);"> </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 automatic-dshbrd-lang">
                                <div class="radio" style="margin-bottom: 2px;">
                                    <label>
                                        <input (change)="onSelectBrowserLangFromRadioBtn($event)" type="radio"
                                            name="dashboardLanguage" value="browserlang"
                                            [checked]="!HAS_SELECTED_PREFERRED_LANG">
                                        {{'AutomaticDashboardLanguage' | translate }}
                                    </label>
                                </div>

                              
                                
                                <div class="browser-lang-wpr"
                                    [ngClass]="{'browser-lang-disabled-wpr':HAS_SELECTED_PREFERRED_LANG }">


                                    <img [src]="flag_url"
                                        style="width: 18px;height: 18px; position: relative;top: -1px;">

                                    <span class="browser-lang" style="font-weight: 300; color: #333;"
                                        [ngClass]="{'not-available-language': !i18n_for_this_brower_language_is_available}">
                                        {{ browser_lang | translate}}
                                    </span>
                                    <span class="not-available-language-string"
                                        *ngIf="!i18n_for_this_brower_language_is_available && hasSelectedBrowserLangRadioBtn && !HAS_SELECTED_PREFERRED_LANG">
                                        ({{'LanguageIsNotAvailableDashboardWillBeTranslatedIntoEnglish'|translate}})
                                    </span>
                                    <span class="not-available-language-string"
                                        *ngIf="!i18n_for_this_brower_language_is_available && !hasSelectedBrowserLangRadioBtn && !HAS_SELECTED_PREFERRED_LANG">
                                        ({{'LanguageIsNotAvailableDashboardHasBeenTranslatedIntoEnglish'|translate}})
                                    </span>

                                </div>
                                <div *ngIf="display_msg_refresh_page_for_browser_lang && hasSelectedBrowserLangRadioBtn"
                                    class="refresh-page" style="margin-top: 3px;">
                                    {{'TheSettingsWillBeAppliedAfterRefreshingTheDashboard' | translate}}
                                    <span style="color: #03a5e8;cursor: pointer;" (click)="refreshPage()">
                                        {{'RefreshNow' | translate}}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <span class="span-12"></span>

                        <div class="row">
                            <div class="col-md-12 preferred-dshbrd-lang">
                                <div class="radio" style="margin-bottom: 6px;">
                                    <label>
                                        <input type="radio" value="preferredlang"
                                            (change)="onSelectPreferredLangFromRadioBtn($event)"
                                            name="dashboardLanguage" [checked]="HAS_SELECTED_PREFERRED_LANG">
                                        {{'PreferredDashboardLanguage' | translate }}
                                    </label>
                                </div>
                            </div>

                            <div class="col-sm-12">
                                <div class="preferred-lang-selection-wpr">
                                    <ng-select [items]="dashboard_languages" 
                                        bindLabel="name" bindValue="name"
                                        [clearable]="false" 
                                        [(ngModel)]="selected_dashboard_language"
                                        [searchable]="false"
                                        (change)="onSelectPreferredDsbrdLang(selected_dashboard_language)"
                                        placeholder="{{'PreferredDashboardLanguage' | translate}}">
                                        <ng-template ng-label-tmp let-item="item">
                                            <img style="width: 18px;height: 18px;" height="18" width="18" [src]="item.avatar" />
                                            <span>
                                                {{item.name | translate}}
                                            </span>
                                           
                                        </ng-template>
                                        <ng-template ng-option-tmp let-item="item" let-index="index">
                                            <img style="width: 18px;height: 18px;" height="18" width="18" [src]="item.avatar" />
                                            <span>
                                                {{item.name | translate }}
                                            </span>
                                         
                                        </ng-template>

                                    </ng-select>
                                </div>
                                <div *ngIf="display_msg_please_select_language" class="language-not-selected">
                                    {{'PleaseSelectALanguage' | translate}}
                                </div>

                                <!-- <p>display_msg_refresh_page_for_selected_lang {{display_msg_refresh_page_for_selected_lang }}</p> 
                               <p>hasSelectedPreferredLangRadioBtn {{hasSelectedPreferredLangRadioBtn }}</p>  -->
                                <div *ngIf="display_msg_refresh_page_for_selected_lang && hasSelectedPreferredLangRadioBtn"
                                    class="refresh-page">
                                    {{'TheSettingsWillBeAppliedAfterRefreshingTheDashboard' | translate}}
                                    <span style="color: #03a5e8;cursor: pointer;" (click)="refreshPage()">
                                        {{'RefreshNow' | translate}}
                                    </span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- <appdashboard-change-password></appdashboard-change-password> -->

<!-- INFO MODAL: UPDATING PROFILE IN PROGRESS -->
<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display': displayModalUpdatingUser}"
    style="background-color: rgba(90,90,90,0.5);">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content custom--modal-content">
            <div class="modal-header">
                <h4 class="modal-title" style="font-size: 14px;">
                    {{ "UserProfile.UpdateProfile" | translate }}
                </h4>
                 <button type="button" class="btn-close" aria-label="Close" (click)="closeModalUpdatingUser()"></button>
            </div>

            <div class="modal-body" style="padding-right: 15px; padding-top:15px; padding-bottom:15px; font-size: 14px;">

                <span *ngIf="SHOW_CIRCULAR_SPINNER">
                    <div class="loader" style="top:25%;">
                        <svg class="circular" viewBox="25 25 50 50">
                            <circle class="path" cx="50" cy="50" r="15" fill="none" stroke-width="2"
                                stroke-miterlimit="10" />
                        </svg>

                    </div>
                    <p style="margin-top: 60px; text-align: center; color: #566787; font-weight: 500; font-size: 14px;">
                        {{ "UserProfile.Processing" | translate }}
                    </p>
                </span>

                <!-- IF THERE IS NO ERROR -->
                <span *ngIf="!SHOW_CIRCULAR_SPINNER && !UPDATE_USER_ERROR ">

                    <div style="text-align: center">
                        <i class="material-icons" style="color:#70b665">done</i>
                        <p style="color:#70b665; font-weight: 500; font-size: 14px;" >
                            {{ "UserProfile.Completed" | translate }}
                        </p>

                    </div>
                    <p style="margin-top:10px; text-align: center; color: #566787; font-weight: 500; font-size: 14px;">
                        {{ "UserProfile.UserSuccessfullyUpdated" | translate }}
                    </p>
                </span>

                <!-- IF THERE IS AN ERROR -->
                <span *ngIf="!SHOW_CIRCULAR_SPINNER && UPDATE_USER_ERROR">
                    <div style="text-align: center ">
                        <i class="material-icons" style="color:#ff5252">report_problem</i>
                        <p style="color:#ff5252; font-weight: 500">
                            <!-- {{ "UserProfile.Error" | translate }} -->
                            {{ "Error" | translate }}
                        </p>

                    </div>
                    <p style="margin-top:10px; text-align: center; color: #566787; font-weight: 500; font-size: 14px;">
                        {{ "UserProfile.AnErrorHasOccurred" | translate }}
                    </p>
                </span>
            </div>

            <div class="modal-footer" style="text-align: center; border-top:unset; background-color:unset">
                <button class="btn btn-tdblu-no-boxshadow" [disabled]="SHOW_CIRCULAR_SPINNER"
                    (click)="closeModalUpdatingUserHandler()" style="padding:12px 16px;">
                    {{ "UserProfile.Continue" | translate }}
                </button>
            </div>

        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>