<!-- <span class="navbar-brand navbar-brand-sidebar-settings"
  [ngStyle]="{'margin-top':isChromeVerGreaterThan100 === true ? '-64px' : '6px' }"
  [ngClass]="{'is_opened':IS_OPEN_SETTINGS_SIDEBAR, 'is_closed':!IS_OPEN_SETTINGS_SIDEBAR }">
  <i class="material-icons">settings</i>
  <span *ngIf="IS_OPEN_SETTINGS_SIDEBAR">Chatbots </span>
</span> -->
<span class="navbar-brand navbar-brand-sidebar-settings"
  [ngStyle]="{'margin-top':isChromeVerGreaterThan100 === true ? '-64px' : '6px' }"
  [ngClass]="{'is_opened':IS_OPEN_SETTINGS_SIDEBAR, 'is_closed':!IS_OPEN_SETTINGS_SIDEBAR }">

  <div class="chatbot-svg-icon">
    <!-- <svg version="1.1" id="Objects" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
      x="0px" y="0px" viewBox="0 0 30 30" style="enable-background:new 0 0 30 30;width: 29px;height: 29px;"
      xml:space="preserve">
      <style type="text/css">
        .cb--0 {
          fill: #3C4858;
        }
      </style>
      <g>
        <path class="cb--0" d="M24.6,12.6c-0.1,0-0.2,0-0.3,0c-1.6-2.9-4.5-5.8-9.2-5.8s-7.6,2.9-9.2,5.8c-0.2,0-0.4-0.1-0.6-0.1
            c-2,0-3.5,2.3-3.5,5c0,2.8,1.6,5,3.5,5c0.1,0,0.3,0,0.4,0c2.3,3.6,7,3.9,9.4,3.9c2.3,0,6.9-0.5,9.2-3.9c0.1,0,0.1,0,0.2,0
            c2,0,3.5-2.3,3.5-5C28.1,14.8,26.6,12.6,24.6,12.6z M22,21.1c0,0-7.8,2.3-14.3-0.1c0,0-0.8-4.1-0.5-7.2c0,0,8.1-3.2,15.6,0.3
            C22.8,14.1,23.3,19.1,22,21.1z" />
        <ellipse class="cb--0" cx="11.9" cy="17.4" rx="0.7" ry="1.4" />
        <ellipse class="cb--0" cx="18.1" cy="17.4" rx="0.7" ry="1.4" />
        <path class="cb--0" d="M14.5,5.3v1.1h1V5.3C15.8,5.1,16,4.8,16,4.5c0-0.5-0.4-0.9-1-0.9c-0.5,0-0.9,0.4-0.9,0.9
            C14.1,4.8,14.2,5.1,14.5,5.3z" />
      </g>
    </svg> -->

    <!-- <svg xmlns="http://www.w3.org/2000/svg" height="29px" viewBox="0 -960 960 960" width="29px" fill="#3C4858">
      <path
        d="M160-120v-200q0-33 23.5-56.5T240-400h480q33 0 56.5 23.5T800-320v200H160Zm200-320q-83 0-141.5-58.5T160-640q0-83 58.5-141.5T360-840h240q83 0 141.5 58.5T800-640q0 83-58.5 141.5T600-440H360ZM240-200h480v-120H240v120Zm120-320h240q50 0 85-35t35-85q0-50-35-85t-85-35H360q-50 0-85 35t-35 85q0 50 35 85t85 35Zm0-80q17 0 28.5-11.5T400-640q0-17-11.5-28.5T360-680q-17 0-28.5 11.5T320-640q0 17 11.5 28.5T360-600Zm240 0q17 0 28.5-11.5T640-640q0-17-11.5-28.5T600-680q-17 0-28.5 11.5T560-640q0 17 11.5 28.5T600-600ZM480-200Zm0-440Z" />
    </svg> -->

    <svg xmlns="http://www.w3.org/2000/svg" height="29px" viewBox="0 -960 960 960" width="29px" fill="#3C4858">
      <path
        d="M151.33-370.67q-46.66 0-79-32.47Q40-435.61 40-482t32.47-78.86q32.47-32.47 78.86-32.47V-702q0-27 19.84-46.83Q191-768.67 218-768.67h150.67q0-46.66 32.47-79Q433.61-880 480-880t78.86 32.47q32.47 32.47 32.47 78.86H742q27 0 46.83 19.84Q808.67-729 808.67-702v108.67q46.66 0 79 32.47Q920-528.39 920-482t-32.47 78.86q-32.47 32.47-78.86 32.47v184q0 27-19.84 46.84Q769-120 742-120H218q-27 0-46.83-19.83-19.84-19.84-19.84-46.84v-184ZM348.82-464q19.51 0 33.01-13.66 13.5-13.65 13.5-33.16 0-19.51-13.65-33.01-13.66-13.5-33.17-13.5t-33.01 13.65Q302-530.02 302-510.51t13.66 33.01q13.65 13.5 33.16 13.5Zm262.67 0q19.51 0 33.01-13.66 13.5-13.65 13.5-33.16 0-19.51-13.66-33.01-13.65-13.5-33.16-13.5-19.51 0-33.01 13.65-13.5 13.66-13.5 33.17t13.65 33.01q13.66 13.5 33.17 13.5ZM314.67-283.33h330.66V-350H314.67v66.67ZM218-186.67h524V-702H218v515.33Zm262-258Z" />
    </svg>

  </div>

  <span class="chatbot-sidebar-title" *ngIf="IS_OPEN_SETTINGS_SIDEBAR">Chatbots </span>

</span>




<div class="main-content" style="padding-top:0px; padding-left: 5px;padding-right: 5px;">
  <div class="page-title--sidebar-settings"
    [ngClass]="{'page-title--sidebar-settings_opened':IS_OPEN_SETTINGS_SIDEBAR, 'page-title--sidebar-settings_closed':!IS_OPEN_SETTINGS_SIDEBAR }">
    My Chatbots
  </div>
  <div class="container-fluid" style="padding-left: 5px;padding-right: 5px;">

    <div class="content-wpr" style="display: flex;">

      <appdashboard-bots-sidebar [allTemplatesCount]="allTemplatesCount"
        [allCommunityTemplatesCount]="allCommunityTemplatesCount"
        [customerSatisfactionTemplatesCount]="customerSatisfactionTemplatesCount"
        [increaseSalesTemplatesCount]="increaseSalesTemplatesCount" [myChatbotOtherCount]="myChatbotOtherCount"
        [customerSatisfactionBotsCount]="customerSatisfactionBotsCount"
        [increaseSalesBotsCount]="increaseSalesBotsCount" [kbCount]="kbCount">
      </appdashboard-bots-sidebar>
      <div class="teplate-content" style="flex: 1 1 auto; margin-left: 15px;">

        <!-- -------------------------------------------------------------------- -->
        <!-- Alert displayed when the number of chatbot exceed the chatbot limit -->
        <!-- -------------------------------------------------------------------- -->

        <ng-container *ngIf="chatBotLimit || chatBotLimit === 0 ">
          <appdashboard-chatbot-alert *ngIf="chatBotCount > chatBotLimit && isVisiblePAY"></appdashboard-chatbot-alert>
        </ng-container>
        <div class="row">
          <div class="col-xs-12">
            <button class="btn btn-tdblu-no-boxshadow pull-right" (click)="createBlankTilebot()"
              style="margin-right: 20px">
              Create from scratch
            </button>
            <button class="btn btn-outlined pull-right" (click)="goToBotAllTemplates()" style="margin-right: 16px">
              Add from template
            </button>
          </div>
        </div>


        <div class="row">
          <div class="col-xs-12">

            <div class="card card--no-border" style="margin-top: 5px;">
              <!-- <div class="card-header card-header-custom-bkgrnd">

              </div> -->
              <!-- ------------------------------------------------------------------ -->
              <!-- Go to tempaltes -->
              <!-- ------------------------------------------------------------------ -->
              <!-- <div (click)="goToBotsTemplates()">Bot templates </div> -->

              <loading-spinner *ngIf="showSpinner"></loading-spinner>
              <!-- New chatbot list -->
              <div *ngIf="!showSpinner" class="main--wrapper">
                <div class="page-title--wrapper">
                  <div class="title--header">
                    <!-- {{ pageName }} -->
                  </div>

                  <div class="page--actions" *ngIf="faqkbList && faqkbList?.length > 0">
                    <span class="order-by-label">Order by </span>

                    <div class="dropdown" (click)="isOpenDropdown(isOpen = !isOpen)">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                        <span class="order-by-selected-value" *ngIf="orderBylastUpdated">Last updates </span>
                        <span class="order-by-selected-value" *ngIf="orderByCreationDate">Creation date </span>
                        <span class="order-by-selected-value" *ngIf="orderByChatbotName">Name </span>
                        <span class="caret dropdown-caret"
                          [ngClass]="{'caret-rotate-0': is0penDropDown === false, 'caret-rotate-180': is0penDropDown === true}"></span>
                      </a>
                      <ul class="dropdown-menu" style="left: -53px;">
                        <li>
                          <a (click)="orderBy('lastUpdates')">
                            Last updates
                          </a>
                        </li>
                        <li>
                          <a (click)="orderBy('creationDate')">
                            Creation date
                          </a>
                        </li>
                        <li>
                          <a (click)="orderBy('botname')">
                            Name
                          </a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>

                <div *ngIf="faqkbList && faqkbList?.length === 0" class="no-bot-tr-msg-wpr">

                  <p class="no-bot-msg">
                    <!-- <i class="material-icons" style="vertical-align: middle; margin-bottom: 2px;color: #00bcd4;">
                        info
                      </i>
                      {{ 'BotsPage.NoBot' | translate }} -->

                    <span style="display: block;">
                      You don't have Chatbots.
                    </span>
                    <span style="display: block;">
                      Get you started with a <span class="btn---link" (click)="goToBotAllTemplates()"> chatbot
                        template </span> or create a new one from scratch
                    </span>
                    <span style="display: block;">
                      <!-- <span class="btn---link" (click)="createBlankTilebot()"> create a new one from scratch
                        </span> -->
                      <!-- btn-new btn-size-m btn--primary -->
                      <button class="btn btn-tdblu-no-boxshadow center" (click)="createBlankTilebot()"
                        style="margin-right: 20px; box-shadow: unset;">
                        Create from scratch
                      </button>
                    </span>
                  </p>
                </div>

                <!-- ---------------------------------------------- -->
                <!-- Popover for the icon human in the loop -->
                <!-- ---------------------------------------------- -->
                <sat-popover #botAvailableForAgents horizontalAlign="center" verticalAlign="above"
                  panelClass="custom-panel-sat-popover" 
                  closeTransition="1ms ease-in"
                  (mouseenter)="cancelClosePopover()" 
                  (mouseleave)="scheduleClosePopover()" 
                  forceAlignment="true">

                  <div class="custom-panel-sat-popover-content-wpr" style="padding: 12px;">

                    <div class="custom-panel-sat-popover-title">
                      Available to agents
                    </div>

                    <div class="custom-panel-sat-popover-description">
                      Chatbot visible to agents for the purpose to be put back in the conversation
                    </div>

                  </div>
                </sat-popover>

                <div class="card-list" *ngFor="let faqkb of faqkbList; let i = index">

                  <div class="cl-card" (click)='goToBotDtls(faqkb)'>
                    <div class="cl-card-content">

                      <div class="cl-card-first-column">

                        <div class="bot-type-logo-wpr" *ngIf="faqkb.type === 'internal'">
                          <div class="bot-type-logo--img-wpr " style="top: -39px; left: 14px;">
                            <img class="bot-type-logo" src="assets/img/tiledesk_logo_no_text.png" />
                          </div>
                        </div>

                        <div class="bot-type-logo-wpr" *ngIf="faqkb.type === 'external'">
                          <div class="bot-type-logo--img-wpr" style="top: -39px; left: 14px;">
                            <img class="bot-type-logo" src="assets/img/external_bot_logo.png" />
                          </div>
                        </div>

                        <div class="bot-type-logo-wpr" *ngIf="faqkb.type === 'dialogflow'">
                          <div class="bot-type-logo--img-wpr ">
                            <img class="bot-type-logo" src="assets/img/Dialogflow_logo_no_text.png" />
                          </div>
                        </div>

                        <div class="bot-type-logo-wpr" *ngIf="faqkb.type === 'rasa'">
                          <div class="bot-type-logo--img-wpr ">
                            <img class="bot-type-logo" src="assets/img/rasa_bot_logo.png" />
                          </div>
                        </div>

                        <div class="bot-type-logo-wpr" *ngIf="faqkb.type === 'tilebot'">
                          <div class="bot-list-type-logo-img-wpr ">
                            <img class="bot-type-logo" [src]="botLogo" />
                          </div>
                        </div>

                        <div class="cl-card-img-wpr">

                          <img *ngIf="UPLOAD_ENGINE_IS_FIREBASE"
                            src="https://firebasestorage.googleapis.com/v0/b/{{storageBucket}}/o/profiles%2F{{faqkb?._id}}%2Fphoto.jpg?alt=media"
                            onerror="this.src='assets/img/avatar_bot_tiledesk.svg'" />

                          <img *ngIf="!UPLOAD_ENGINE_IS_FIREBASE" [src]="faqkb.botImage"
                            onerror="this.src='assets/img/avatar_bot_tiledesk.svg'" />

                        </div>

                        <div class="cl-card-info-wpr">
                          <span class="cl-card-item-name-wpr">


                            <div class="cl-card-item-name">

                              <span *ngIf="botIdToRename !== faqkb._id">{{ faqkb.name }}</span>
                              <input *ngIf="botIdToRename === faqkb._id" type="text" [(ngModel)]="faqkb.name"
                                (ngModelChange)="changeChatBotName($event)" (click)="$event.stopPropagation()"
                                (keypress)="onPressEnterUpdateChatBotName($event);$event.stopPropagation() ">
                            </div>
                          </span>
                          <div class="cl-card-item-description-wpr">
                            <!-- <div class="bot-card-bot-no-description" *ngIf="!faqkb.description"> No description provided</div> -->
                            <div class="cl-card-item-description" *ngIf="faqkb.description"> {{ faqkb?.description }}
                            </div>
                          </div>

                          <div class="cl-card-item-info">

                            {{'Created' | translate}} {{ faqkb?.createdAt | amTimeAgo}} / {{ "Updated" | translate }} {{
                            faqkb?.updatedAt | amTimeAgo }}

                          </div>

                        </div>
                      </div>

                      <!-- ---------------------------------------------- -->
                      <!-- Icon human in the loop -->
                      <!-- ---------------------------------------------- -->
                      <div class="cl-card-second-column">
                        <div *ngIf="faqkb.agents_available === true || faqkb.agents_available === undefined" class="cl-availble-for-agent"
                          style="position: relative; top: 1px;height: 24px;" 
                          [satPopoverAnchor]="botAvailableForAgents"
                          (mouseenter)="openPopover()" 
                          (mouseleave)="scheduleClosePopover()">
                          <span class="material-icons">boy</span>
                        </div>
                        <div class="cl-card-stats-wpr">

                          <div *ngIf="faqkb.type === 'tilebot'" class="cl-card-item-stats">
                            <div class="cl-card-item-stats-title">
                              <span *ngIf="faqkb.published"> Published </span>
                              <span *ngIf="!faqkb.published"> Draft </span>
                            </div>

                            <div class="cl-card-item-stats-values">
                              <span *ngIf="faqkb.published" class="material-icons bot-published-icon">
                                done
                              </span>

                              <span *ngIf="!faqkb.published" class="material-icons bot-unpublished-icon">
                                error_outline
                              </span>
                            </div>
                          </div>

                          <div *ngIf="isVisibleAnalytics" class="cl-card-item-stats">
                            <div class="cl-card-item-stats-title">
                              <!-- {{ "BotsAddEditPage.Messages" | translate }} -->
                              Messages
                            </div>
                            <div class="cl-card-item-stats-values">
                              {{ faqkb?.message_count}}
                            </div>
                          </div>



                        </div>

                        <div class="cl-card-action-wpr">
                          <div class="cl-card-action-group">
                            <div *ngIf="isVisibleAnalytics" class="cl-card-action-btn-wpr">
                              <button id="btn-{{faqkb._id}}" mat-icon-button
                                (click)="$event.stopPropagation();openBotMsgsStats(faqkb)"
                                matTooltipClass="custom-mat-tooltip" matTooltip="Messages" #tooltip="matTooltip"
                                matTooltipPosition='below' matTooltipHideDelay="100">
                                <mat-icon>leaderboard</mat-icon>
                              </button>
                            </div>

                            <div class="cl-card-action-btn-wpr" (click)="$event.stopPropagation()">
                              <button id="share-btn-{{faqkb._id}}" mat-icon-button [matMenuTriggerFor]="menu"
                                matTooltipClass="custom-mat-tooltip" matTooltip="Share" #tooltip="matTooltip"
                                matTooltipPosition='below' matTooltipHideDelay="100">
                                <mat-icon>share</mat-icon>
                              </button>
                              <mat-menu #menu="matMenu">
                                <button class="mat-menu-btn" mat-menu-item
                                  (click)='shareWithLink(faqkb._id, faqkb?.name)'>
                                  <mat-icon>link</mat-icon>
                                  <span>Share with link</span>
                                </button>

                                <button class="mat-menu-btn" mat-menu-item (click)='exportChatbotToJSON(faqkb)'>
                                  <mat-icon>file_download</mat-icon>

                                  <span>Export</span>
                                </button>
                                <!-- <button *ngIf="!faqkb?.is_system_identity_bot" mat-menu-item 
                                (click)='openDeleteModal(faqkb?._id, faqkb?.name, faqkb?.has_faq, faqkb?.type)'>
                                <mat-icon>delete</mat-icon>
                                <span>{{ 'BotsPage.tooltipDeleteBot' | translate }}</span>
                              </button> -->
                              </mat-menu>
                            </div>

                            <div class="cl-card-action-btn-wpr" (click)="$event.stopPropagation()">
                              <button mat-icon-button [matMenuTriggerFor]="sharemenu"
                                matTooltipClass="custom-mat-tooltip" matTooltip="Actions" #tooltip="matTooltip"
                                matTooltipPosition='below' matTooltipHideDelay="100">
                                <mat-icon>more_vert</mat-icon>
                              </button>
                              <mat-menu #sharemenu="matMenu">

                                <!-- <button class="mat-menu-btn" 
                                  mat-menu-item 
                                  (click)='renameChatbot(faqkb)'>
                                  <mat-icon>edit</mat-icon>
                                  <span>Rename</span>
                                </button> -->

                                <button class="mat-menu-btn" mat-menu-item
                                  (click)="openTestSiteInPopupWindow(faqkb?._id)">
                                  <mat-icon>visibility</mat-icon>
                                  <span>Test it out</span>
                                </button>

                                <button class="mat-menu-btn" mat-menu-item
                                  (click)='duplicateChatbot(faqkb?._id,  faqkb?.name)'>
                                  <mat-icon>content_copy</mat-icon>
                                  <!-- <span>{{ 'Duplicate' | translate }}</span> -->
                                  <span>Duplicate</span>
                                </button>
                                <button class="mat-menu-btn" *ngIf="!faqkb?.is_system_identity_bot" mat-menu-item
                                  (click)='openDeleteModal(faqkb?._id, faqkb?.name, faqkb?.has_faq, faqkb?.type)'>
                                  <mat-icon>delete</mat-icon>
                                  <!-- <span>{{ 'BotsPage.tooltipDeleteBot' | translate }}</span> -->
                                  <span>Delete</span>
                                </button>
                              </mat-menu>

                            </div>

                          </div>
                        </div>

                      </div>

                    </div>
                  </div>
                </div>
              </div>


              <!-- ./ New chatbot list -->

            </div>
          </div>
          <!-- /. end col-md-12 -->



        </div>
      </div>
      <!-- </div> -->
    </div>
  </div>
</div>

<!-- --------------------------------------------- -->
<!-- MODAL WINDOW  -->
<!-- --------------------------------------------- -->

<!-- --------------------------------- -->
<!-- NEW DELETE BOT MODAL WINDOW  -->
<!-- --------------------------------- -->
<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displayDeleteBotModal}"
  style="background-color: rgba(90,90,90,0.5);">
  <div class="modal-dialog" role="document">
    <div class="modal-content custom--modal-content">
      <div class="modal-header">
        <button type="button" class="close" aria-label="Close" (click)="onCloseDeleteBotModal()">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title warning">
          <!-- <i class="material-icons" style="vertical-align: middle"> report_problem </i> -->
          <span class="modal-header-icon-wpr">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 -960 960 960" width="20px" fill="none">
              <path
                d="m40-120 440-760 440 760H40Zm115.33-66.67h649.34L480-746.67l-324.67 560ZM482.78-238q14.22 0 23.72-9.62 9.5-9.61 9.5-23.83 0-14.22-9.62-23.72-9.61-9.5-23.83-9.5-14.22 0-23.72 9.62-9.5 9.62-9.5 23.83 0 14.22 9.62 23.72 9.62 9.5 23.83 9.5Zm-33.45-114H516v-216h-66.67v216ZM480-466.67Z" />
            </svg>
          </span>
          <span style="vertical-align: middle; padding-left:8px">
            {{ "BotsPage.DeleteBot" | translate }}
          </span>
        </h4>
        <!-- <h4 class="modal-title" style="color: #fff; padding-top:10px; font-size: 1.1em ">
          {{ "BotsPage.TheBotWithID" | translate }}
          <code>{{ id_toDelete }}</code>
          {{ "BotsPage.WillBeDeleted" | translate }}
        </h4> -->
      </div>
      <div class="modal-body">
        <!-- <p style="font-weight: 400; color: rgba(0,0,0,0.87)">
          {{ "BotsPage.IfYouDeletedTheBot" | translate }}

          <strong> “{{ bot_name_to_delete}}”</strong>,

          {{ "BotsPage.YouAlsoDeleteItsFaqs" | translate }}
        </p> -->

        <label class="col-sm-10 modal-body--content">
          {{ "BotsPage.ToDeleteTheBotType" | translate }}
          <strong> {{id_toDelete}}</strong>

        </label>
        <div class="col-sm-10">
          <input [(ngModel)]="bot_id_typed" (input)="checkIdBotTyped()" class="" type="text" placeholder="ID bot">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-gray-no-boxshadow" (click)="onCloseDeleteBotModal()">
          {{ "Cancel" | translate }}
        </button>
        <button style="margin-top:0px" class="btn btn-red" [disabled]="!ID_BOT_TYPED_MATCHES_THE_BOT_ID"
          (click)="trashTheBot()">
          {{ "BotsPage.DeleteBot" | translate }}
        </button>
      </div>
    </div>
  </div>
</div>