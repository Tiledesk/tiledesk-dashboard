<div class="main-content" style="padding-top:0px; padding-left: 5px;padding-right: 5px;margin-top: 0px;">
    <div class="container-fluid" style="padding-left: 5px;padding-right: 5px;">
        <div class="row">
            <div class="chatbot-general-setting-tab-wpr">
                <ul class="cds-bottom-nav" style="margin-bottom: 16px;     background: #0f172a;   box-shadow: 0 2px 0px #00003c14 !important;">
                    <li (click)="toggleTab(details = !details)" class="btn-with-border-effect" [ngClass]="
                        { 'disabled-li' :        HAS_SELECTED_BOT_IMPORTEXORT === false, 
                          'border-from-center' : HAS_SELECTED_BOT_IMPORTEXORT === true,
                          'li-active' :          HAS_SELECTED_BOT_IMPORTEXORT === false
                        }">

                        <a href="javascript:;" role="button"> {{ "BotDetails" | translate }} </a>
                    </li>

                    <li (click)="toggleTab(details = !details)" class="btn-with-border-effect" [ngClass]="
                    { 'disabled-li' : HAS_SELECTED_BOT_IMPORTEXORT === true, 
                      'border-from-center' : HAS_SELECTED_BOT_IMPORTEXORT === false, 
                      'li-active' : HAS_SELECTED_BOT_IMPORTEXORT === true
                    }">
                        <a href="javascript:;" role="button"> Chatbot Import Export </a>
                    </li>
                </ul>
            </div>
        </div>

        <div *ngIf="HAS_SELECTED_BOT_DETAILS" class="chatbot-details-wpr">
            <div class="row">
                <div class="col-sm-10 col-md-10">
                    <h3 class="card_title__underlined" style="color: #e8eaed;">
                        <span class="card_title__underline">

                            {{ "UserProfile.Profile" | translate }}
                        </span>
                    </h3>
                </div>
                <div class="col-sm-10 col-md-10">
                    <div class="section-subtitle"> </div>
                </div>
            </div>


            <!--  --------------------------------------------------------------------------------------------------- -->
            <!--  Bot avatar (for all bot type) -->
            <!--  --------------------------------------------------------------------------------------------------- -->
            <div class="row">
                <label class="col-sm-2 cds-bot_avatar_label">
                    Avatar
                </label>
                <div class="col-sm-10">
                    <!-- [ngStyle]="{'margin-left':botType === 'dialogflow' ? '35px' : 0 }" -->
                    <div class="card-avatar" style="padding-bottom:15px; display: flex;align-items: center;">
                        <div class="bot_avatar" style="width: 80px; height: 80px;margin-right: 20px;">

                            <img *ngIf="botProfileImageExist === true || botImageHasBeenUploaded === true"
                                class="bot-profile-img" [src]="getBotProfileImage()"
                                onerror="this.src='assets/img/avatar_bot_tiledesk.svg'" />

                            <img *ngIf="botProfileImageExist === false && botImageHasBeenUploaded !== true"
                                class="bot-profile-img" src="assets/img/avatar_bot_tiledesk.svg" />
                        </div>


                        <input #fileInputBotProfileImage class="inputfile" name="uploadbotimage" 
                            type="file" (change)="upload($event)" accept=".jpg, .JPEG, .png" />
                        <label class="btn btn-white upload-image-btn" for="uploadbotimage" id="csd-upload-bot-image-btn">


                            <span *ngIf="!showSpinnerInUploadImageBtn">
                                {{ "UserProfile.UploadImage" | translate }}
                            </span>
                            <span *ngIf="showSpinnerInUploadImageBtn">
                                {{ 'VisitorsPage.Loading' | translate }}
                                <i class="fa fa-spinner fa-spin"></i>
                            </span>
                        </label>

                        <button id="cds-delete-bot-img-btn" class="btn btn-white delete_bot_image_btn tool_tip" 
                            (click)="deleteBotProfileImage()">
                            <span class="material-icons" style="font-size: 24px; color: #fff">
                                delete_forever
                            </span>

                            <span class="bottom"
                                style="min-width: fit-content;padding: 5px;border-radius: 3px; text-transform: none;">
                                {{'RemovePhoto' | translate}}
                                <i></i>
                            </span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- ------------------------------------------------------------------------------------------- -->
            <!--  Bot type  -->
            <!-- ------------------------------------------------------------------------------------------- -->
            <div class="row" style="margin-bottom: 16px;">
                <label class="col-sm-2 cds-custom-label">
                    {{ "BotsAddEditPage.Type" | translate }}
                </label>
                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <input id="bot_type" name="bot_type" [(ngModel)]="botTypeForInput" class="input" type="text"
                        style="margin-bottom: 0px; color:#808080" disabled>
                </div>
            </div>


            <!-- ------------------------------------------------------------------------------------------- -->
            <!-- Bot name  -->
            <!-- ------------------------------------------------------------------------------------------- -->
            <div class="row" style="margin-bottom: 16px;">
                <label class="col-sm-2 cds-custom-label">
                    {{ "BotsAddEditPage.BotName" | translate }}
                </label>
                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <input id="faqKb_name" name="faqKb_name" [(ngModel)]="faqKb_name" class="input" type="text">
                </div>
            </div>

            <!-- ------------------------------------------------------------------------------------------- -->
            <!-- Bot language  -->
            <!-- ------------------------------------------------------------------------------------------- -->
            <div class="row" style="margin-bottom: 8px;">
                <!-- style="padding-top: 0px; line-height: 1.2;" -->
                <label class="col-sm-2 cds-custom-label">
                    {{ "ResolutionBotLanguage" | translate }}
                </label>
                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">

                    <input id="bot-default-selected-lang" name="bot-default-selected-lang"
                        [(ngModel)]="botDefaultSelectedLang" class="input" type="text" disabled>
                </div>
            </div>

            <!-- SPACER -->
            <div class="col-sm-12" style="height:10px"></div>

            <!-- ------------------------------------------------------------------------------------------- -->
            <!-- Description  -->
            <!-- ------------------------------------------------------------------------------------------- -->
            <div class="row">
                <label class="col-sm-2 cds-custom-label">
                    {{ 'Description' | translate }}
                </label>
                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <textarea id="bot_description" name="bot_description" [(ngModel)]="faqKb_description" rows="2"
                        style="resize: vertical;" class="input" type="text"
                        placeholder="{{ 'Description' | translate }}">
            </textarea>
                </div>
            </div>


            <!-- ------------------------------------------------------------------------------------------- -->
            <!-- Update button  -->
            <!-- ------------------------------------------------------------------------------------------- -->
            <div class="row">
                <label class="col-xs-2"></label>
                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <button id="csd-update-bot-btn" style="margin-top: 12px;margin-bottom: 5px;" #editbotbtn
                        class="btn btn-primary  pull-right" (click)="editBot()" [disabled]="faqKb_name?.length === 0">
                        {{ "BotsAddEditPage.UpdateBotName" | translate }}
                    </button>
                </div>
            </div>

            <!-- ---------------------------------------------------------- -->
            <!-- Department to which the bot is associated -->
            <!-- ---------------------------------------------------------- -->
            <div *ngIf="isVisibleDEP === true" class="row" style="margin-bottom: 4px;">


                <div class="col-sm-10 col-md-10">
                    <h3 class="card_title__underlined" style="color: #e8eaed;">
                        <span class="card_title__underline">

                            {{ 'Departments' | translate }}
                        </span>
                    </h3>
                </div>
                <div class="col-sm-10 col-md-10">
                    <div class="section-subtitle"> </div>
                </div>

                <!-- USE CASE: THE BOT IS ASSOCIATED -->
                <div *ngIf="DEPTS_BOT_IS_ASSOCIATED_WITH_ARRAY.length > 0" class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <span style="font-family: 'Poppins';color: #394f5a; font-weight: 400;">
                        {{ "DepartmentsThisBotIsAssociatedWith" | translate }}
                    </span>
                    <div *ngFor="let dept of DEPTS_BOT_IS_ASSOCIATED_WITH_ARRAY" style="margin-bottom: 8px;">
                        <span class="dept-avatar-wrapper" (click)="goToEditAddPage_EDIT_DEPT(dept?._id, dept?.default)">

                            <span class="dept-avatar-in-bot-dtl"
                                [ngStyle]="{'background-color': dept?.dept_name_fillcolour }">
                                {{ dept?.dept_name_initial }}
                            </span>
                            <span class="dept-name-in-bot-dtl">
                                {{ dept?.name }}
                            </span>
                        </span>
                    </div>
                </div>

                <!-- USE CASE: THIS BOT IS NOT ASSOCIATED BUT ALL DEPARTMENTS ALREADY HAVE A BOT -->
                <div *ngIf="DEPTS_HAVE_BOT_BUT_NOT_THIS === true && depts_without_bot_array?.length === 0"
                    class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <span style="font-family: 'Poppins';color: #e8eaed; font-weight: 400;">
                        {{ 'NoDeptsAreAssociatedWithThisBot' | translate}}
                    </span>
                </div>

                <!-- USE CASE: THIS BOT IS NOT ASSOCIATED AND SOME DEPARTMENTS DON'T HAVE A BOT -->
                <div *ngIf="depts_without_bot_array?.length > 0 && DEPTS_BOT_IS_ASSOCIATED_WITH_ARRAY?.length === 0"
                    class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <span style="font-family: 'Poppins';color: #e8eaed; font-weight: 400;">
                        {{ 'NoDeptsAreAssociatedWithThisBot' | translate}}
                    </span>

                    <div class="input-group" *ngIf="depts_without_bot_array?.length > 0">
                        <ng-select [items]="depts_without_bot_array" bindValue="id" bindLabel="name"
                            placeholder="{{'SelectDepartment'|translate}}" [(ngModel)]="selected_dept_id"
                            (change)="onSelectDept()">
                        </ng-select>

                        <span class="input-group-btn">
                            <button class="btn btn-tdblu-no-boxshadow" (click)="hookBotToDept()"
                                [disabled]="!selected_dept_id" style="margin-top:0px; padding-top: 8px !important;padding-bottom: 8px!important; margin-bottom: 0px; border-top-left-radius: 3px;
                border-bottom-left-radius: 3px;">
                                <span> {{ 'ActivateBot' | translate}} </span>
                            </button>
                        </span>
                    </div>
                </div>

            </div>
            <div class="row">

                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                    <span style="color: #9aa0a6;font-size: 12px;font-weight: 400;">
                        {{'ManageTheBotIn' | translate}}

                        <span class="custom-link" (click)="goToRoutingAndDepts()">
                            {{'RoutingAndDepts' | translate}}
                        </span>
                    </span>
                </div>
            </div>
        </div> <!-- ./ bot details -->


        <div *ngIf="HAS_SELECTED_BOT_IMPORTEXORT" class="chatbot-faq-export-import-wpr">

            <div class="row">
              <div class="col-sm-10 col-md-10">
                <h3 class="card_title__underlined">
                  <span class="card_title__underline">

                    JSON
                  </span>
                </h3>
              </div>
              <div class="col-sm-10 col-md-10">
                <div class="section-subtitle"> </div>
              </div>
            </div>

            <!-- Export FAQ to Json Btn-->
            <span class="export-faq-to-json-btn-wpr">
              <button class="btn btn-primary export-faq-to-json-btn" (click)="exportFaqToJSON()">
                <span class="icon" style="padding-right:8px">
                  <span class="material-icons">
                    cloud_download
                  </span>
                </span>
                Export Chatbot to JSON
              </button>
            </span>

            <!-- Import FAQ to Json Btn-->
            <span class="import-faq-from-json-btn-wpr" style="margin-left: 16px;">
              <input style="display:inline" name="fileChangeUploadFromJSON" id="fileChangeUploadFromJSON"
                class="inputfile" type="file" (change)="fileChangeUploadJSON($event)" accept=".txt" />
              <label class="btn btn-primary" for="fileChangeUploadFromJSON">
                <span class="material-icons" style="padding-right: 8px;">
                  cloud_upload
                </span>
                Import FAQ from JSON
              </label>
            </span>

            <span class="create-bot-from-json-btn-wpr" style="margin-left: 16px;">
              <input style="display:inline" name="fileChangeUploadFromJSON" id="fileChangeUploadFromJSON"
                class="inputfile" type="file" (change)="fileChangeUploadJSON($event)" accept=".txt" />
              <label class="btn btn-primary" for="fileChangeUploadFromJSON">
                <span class="material-icons" style="padding-right: 8px;">
                  cloud_upload
                </span>
                Create Chatbot from JSON
              </label>
            </span>

            <div class="row">
              <div class="col-sm-10 col-md-10">
                <h3 class="card_title__underlined" style="margin-top: 30px;">
                  <span class="card_title__underline">

                    CSV
                  </span>
                </h3>
              </div>
              <div class="col-sm-10 col-md-10">
                <div class="section-subtitle"> </div>
              </div>
            </div>

            <div class="import-faq-from-csv-btn-wpr">
              <button class="btn btn-primary export-faq-to-json-btn" (click)="openImportModal()">
                <span class="icon" style="padding-right:8px">
                  <span class="material-icons">
                    cloud_upload
                  </span>
                </span>
                Import FAQ from CSV
              </button>
            </div>
          </div> <!-- ./ faq export import -->

    </div>
</div>

    <!-- -------------------------------------------------------------------------------- -->
    <!-- MODAL WINDOWS -->
    <!-- -------------------------------------------------------------------------------- -->

 <!-- MODAL - INPORT CSV  -->
<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displayImportModal}"
style="background-color: rgba(90,90,90,0.5);">
<!-- modal-sm   -->
<div class="modal-dialog" role="document">
  <div class="modal-content">
    <div class="modal-header" style="padding: 8px 15px;">
      <!-- class="close" -->
      <button type="button" class="close-modal-window" aria-label="Close" (click)="onCloseModal()">
        <span aria-hidden="true"
          style="color: rgb(6, 6, 6) !important;position: relative;top: -2px;">&times;</span>
      </button>

      <h4 class="modal-title" style="line-height: 2!important;">
        <!-- Import CSV file -->
        {{ 'FaqPage.ImportCsvFile' | translate }}
      </h4>
    </div>

    <div class="modal-body" style="padding-bottom: 20px !important; padding-top: 20px;">

      <div class="row" style="margin-right: 0px; margin-bottom:8px">
        <div class="col-xs-10 col-xs-offset-1"
          style="text-align:center; border: 1px solid #3ea9f5;background-color:#3ea9f5; color: #fff">
          <p (click)="downloadExampleCsv()" style="margin:5px; cursor:pointer"> <i class="material-icons"
              style="font-size:18px; top: 4px; position: relative;">save_alt</i>
            {{ 'download' | translate }} <span style="font-weight:400"> {{ 'examplecsv' | translate }} </span>
          </p>
        </div>
        <!-- ----------------------------------- -->
        <!-- Note -> display none -->
        <!-- ----------------------------------- -->
        <div class="col-xs-10 col-xs-offset-1"
          style="text-align:center; border-left: 1px solid #eeeeee; border-right: 1px solid #eeeeee">
          <p style="margin:5px; font-weight: 400;">
            <!-- --------------------- -->
            <!-- Question -->
            <!-- --------------------- -->
            <span>
              <em>
                {{ 'FaqPage.Question' | translate }}*
              </em>
            </span>

            <!-- --------------------- -->
            <!-- Columns Delimiter -->
            <!-- --------------------- -->
            <span>
              <strong>
                {{csvColumnsDelimiter}}
              </strong>
            </span>

            <!-- --------------------- -->
            <!-- Answer -->
            <!-- --------------------- -->
            <span>
              <em>
                {{ 'FaqPage.Answer' | translate }}*
              </em>
            </span>

            <!-- --------------------- -->
            <!-- Columns Delimiter -->
            <!-- --------------------- -->
            <!-- <span>
              <strong>
                {{csvColumnsDelimiter}}
              </strong>
            </span> -->

            <!-- --------------------- -->
            <!-- intent_id -->
            <!-- --------------------- -->
            <!-- <span>
              <em>
                intent id
              </em>
            </span> -->

            <!-- --------------------- -->
            <!-- Columns Delimiter -->
            <!-- --------------------- -->
            <!-- <span>
              <strong>
                {{csvColumnsDelimiter}}
              </strong>
            </span> -->

            <!-- --------------------- -->
            <!-- intent_display_name -->
            <!-- --------------------- -->
            <!-- <span>
              <em>
                intent name
              </em>
            </span> -->

            <!-- --------------------- -->
            <!-- Columns Delimiter -->
            <!-- --------------------- -->
            <!-- <span>
              <strong>
                {{csvColumnsDelimiter}}
              </strong>
            </span> -->

            <!-- --------------------- -->
            <!-- webhook_enabled -->
            <!-- --------------------- -->
            <!-- <span>
              <em>
                webhook enabled
              </em>
            </span> -->

            <!-- <span style="display: block;font-size: 12px;font-weight: 400;color: rgb(100, 116, 145);">
              ({{ 'InTheExampleCsFileTheAnswerAndQuestionAreRequired' | translate}})
            </span> -->

          </p>
        </div>

      </div>
      <div class="row" style="margin-right: 0px;">
        <div class="col-sm-12">
          <label
            style="height: 36px; padding-left:16px; padding-right:16px; text-align:right; color: #7695a5;font-weight: 300 !important;"
            class="col-xs-6 col-sm-6 ">
            <!-- Columns separated with: -->
            <!-- {{ 'FaqPage.ColumnsSeparatedWith' | translate }} -->
            {{ 'InTheCSVFileToBeUploadedTheColumnsAreSeparatedBy' | translate}}:
          </label>
          <div class="col-xs-6 col-sm-6" style="text-align:start">
            <input style="padding-left:5px; margin-top:7px; width:55px; border-radius: 5px;
                border: 1px solid #d9d9d9 !important;
                font-weight: 600;
                padding-left: 10px;" [(ngModel)]="csvColumnsDelimiter" (keyup)="countDelimiterDigit($event)">
          </div>

        </div>
        <div class="col-sm-12" style="text-align: center">

          <span *ngIf="modalChoosefileDisabled" style="color:#ff5252">
            <!-- Delimiter option must be one character long  -->
            {{ 'FaqPage.DelimiterOptionMustBe' | translate }}
          </span>
        </div>

      </div>


    </div>

    <div class="modal-footer" style="text-align: center;
        padding-top: 0px !important;
        padding-bottom: 10px;
        background-color: #fff;
        border-top: unset;
        border-bottom-left-radius: 6px;
        border-bottom-right-radius: 6px;">

      <input style="display:inline" name="fileChangeUploadCSV" id="fileChangeUploadCSV" class="inputfile"
        type="file" (change)="fileChangeUploadCSV($event)" accept=".csv" />
      <label class="btn btn-primary" for="fileChangeUploadCSV"
        style="padding-left:15px; padding-right:15px; text-transform: none"
        [ngClass]="{'disabled': modalChoosefileDisabled }">
        <!-- <i class="material-icons">file_upload</i> -->
        <!-- CHOOSE FILE  -->
        {{ 'FaqPage.ChooseFile' | translate }}
      </label>
    </div>

  </div>
  <!-- /.modal-content -->
</div>
<!-- /.modal-dialog -->
</div>


<div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displayInfoModal}"
      style="background-color: rgba(90,90,90,0.5);">
      <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" aria-label="Close" (click)="onCloseModal()">
              <span aria-hidden="true">&times;</span>
            </button>

            <h4 class="modal-title">
              <!-- Upload CSV -->
              {{ 'FaqPage.UploadCsv' | translate }}
            </h4>
          </div>

          <div class="modal-body">

            <span *ngIf="SHOW_CIRCULAR_SPINNER">
              <div class="loader" style="top:25%">
                <svg class="circular" viewBox="25 25 50 50">
                  <circle class="path" cx="50" cy="50" r="15" fill="none" stroke-width="2" stroke-miterlimit="10" />
                </svg>

              </div>
              <p style="margin-top: 50px; text-align: center;">
                <!-- {{ "FaqPage.Processing" | translate }} -->
                {{ "Processing" | translate }}
              </p>
            </span>

            <span *ngIf="!SHOW_CIRCULAR_SPINNER">
              <div class="loader" style="top:5%">

                <!-- // IF SUCCESSFULLY UPLOADED -->
                <span *ngIf="parse_done">
                  <i class="material-icons" style="color:#70b665">done</i>
                  <span style="color:#70b665">
                    {{ "FaqPage.Completed" | translate }}
                  </span>
                </span>

                <!-- // IF AN ERROR OCCURRED DURING THE UPLOAD -->
                <span *ngIf="parse_err">
                  <i class="material-icons" style="color:#ff5252">report_problem</i>
                  <br>
                  <span style="color:#ff5252">
                    <!-- {{ "FaqPage.Error" | translate }} -->
                    {{ "Error" | translate }}
                  </span>
                </span>

              </div>

              <!-- // IF SUCCESSFULLY UPLOADED -->
              <span *ngIf="parse_done">
                <p style="margin-top: 50px; text-align: center;">
                  <!-- FAQs successfully uploaded -->
                  {{ "FaqPage.FaqsSuccessfullyUploaded" | translate }}
                </p>
              </span>

              <!-- // IF AN ERROR OCCURRED DURING THE UPLOAD -->
              <span *ngIf="parse_err">
                <p style="margin-top: 50px; text-align: center;">
                  <!-- An error occurred during the upload -->
                  {{ "FaqPage.AnErrorOccurredDuringTheUpload" | translate }}
                </p>
              </span>

            </span>
          </div>

          <div class="modal-footer" style="text-align: center;">
            <!-- // IF SUCCESSFULLY UPLOADED -->
            <button *ngIf="parse_done" class="btn btn-primary" [disabled]="SHOW_CIRCULAR_SPINNER"
              (click)="onCloseInfoModalHandledSuccess()">
              Ok
            </button>
            <button *ngIf="parse_err" class="btn btn-primary" [disabled]="SHOW_CIRCULAR_SPINNER"
              (click)="onCloseInfoModalHandledError()">
              <!-- Continue -->
              {{ "FaqPage.Continue" | translate }}
            </button>
          </div>

        </div>
        <!-- /.modal-content -->
      </div>
      <!-- /.modal-dialog -->
    </div>