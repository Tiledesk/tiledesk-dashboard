<div *ngIf="previewMode" class="cds-action-preview" style="position: relative;">

    <div class="action-row">
        <div class="action-row-left">
            <svg xmlns="http://www.w3.org/2000/svg" height="20px" viewBox="0 0 24 24" width="20px" fill="none">
                <path d="M0 0h24v24H0V0z" fill="none" />
                <path d="M14 17H4v2h10v-2zm6-8H4v2h16V9zM4 15h16v-2H4v2zM4 5v2h16V5H4z" />
            </svg>
        </div>

        <div class="action-row-right">
            <div *ngIf="action?.question" class="action-row-right">
                {{action?.question}}
            </div>
            <div *ngIf="!action?.question" class="action-row-right empty">
                Enter the question
            </div>
        </div>

    </div>

    <div class="action-row">

        <div id="gpt-icon" class="icon-action">
            <img src="assets/cds/images/actions/openai-icon.svg">
        </div>

        <div class="action-row-right">
            <div *ngIf="action?.model" class="action-row-right">
                {{action?.model}}
            </div>
            <div *ngIf="!action?.model" class="action-row-right empty">
                Enter the question
            </div>
        </div>
    </div>

</div>

<div *ngIf="!previewMode" class="content">


    <div class="textarea-editor-wrapper">
        <label class="title-label">Prompt</label>
        <cds-textarea 
            id="question" 
            [textLimitBtn]="false" 
            [emojiPikerBtn]="false" 
            [setAttributeBtn]="true" 
            [minRow]="2"
            [maxRow]="6" 
            [text]="action.question" 
            [placeholder]="'Enter prompt'"
            (changeTextarea)="changeTextarea($event, 'question')">
        </cds-textarea>
    </div>

    <div class="text-editor-wrapper">
        <div class="field-box">
            <label class="title-label">GPT Reply</label>
            <div class="value-wrp">
                <cds-textarea id="assignTo" 
                    [textLimitBtn]="false" 
                    [emojiPikerBtn]="false" 
                    [setAttributeBtn]="true"
                    [minRow]="1" 
                    [maxRow]="1" 
                    [readonly]="true" 
                    [text]="action.assignReplyTo"
                    (selectedAttribute)="onSelectedAttribute($event, 'assignReplyTo')"
                    (clearSelectedAttribute)="onSelectedAttribute($event, 'assignReplyTo')">
                </cds-textarea>
            </div>
        </div>
    </div>

    <hr class="custom-divider">

    <mat-accordion>
        <mat-expansion-panel (opened)="panelOpenState = true" (closed)="panelOpenState = false"
            class="custom-expansion-panel">
            <mat-expansion-panel-header class="disable_ripple">
                <mat-panel-title>
                    AI Settings
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div>

                <!-- // model select -->
                <div>
                    <div class="select-box">
                        <cds-select 
                            id="text-condition" 
                            [items]="models_list" 
                            [itemSelected]="action.model"
                            [bindLabelSelect]="'name'" 
                            [bindValueSelect]="'value'"
                            (onSelected)="onChangeSelect($event, 'model')">
                        </cds-select>
                    </div>
                </div>

                <!-- // max_tokens slider -->
                <div class="text-editor-wrapper">
                    <div class="field-box">
                        <label class="title-label">Max Tokens</label>
                        <div class="action-wait-content">
            
                            <!-- tickInterval="1000" -->
                            <div class="action-wait-slider ">
                                <div class="action-wait-range">1</div>
                                <mat-slider class="wait-slider" thumbLabel 
                                    [displayWith]="formatLabel"
                                    step="1" min="1" max="512"
                                    [(ngModel)]="action.max_tokens"
                                    (change)="updateSliderValue($event, 'max_tokens')"  
                                    aria-label="units">
                                </mat-slider>
                                <div class="action-wait-range">512</div>
                            </div>
                            <!-- <div style="width: 60px; height: 30px; background-color: white; color: black;">128</div> -->
                            <cds-text [text]="action.max_tokens" [type]="'number'" (onChange)="updateSliderValue($event, 'max_tokens')" class="slider-input"></cds-text>
                        </div>
                    </div>
                </div>

                <!-- // temperature slider -->
                <div class="text-editor-wrapper">
                    <div class="field-box">
                        <label class="title-label">Temperature</label>
                        <div class="action-wait-content">
            
                            <!-- tickInterval="1000" -->
                            <div class="action-wait-slider">
                                <div class="action-wait-range">0</div>
                                <mat-slider class="wait-slider" thumbLabel 
                                    [displayWith]="formatLabel"
                                    step="0.05" min="0" max="1"
                                    [(ngModel)]="action.temperature"
                                    (change)="updateSliderValue($event, 'temperature')"   
                                    aria-label="units">
                                </mat-slider>
                                <div class="action-wait-range">1</div>
                            </div>
                            <!-- <div style="width: 60px; height: 30px; background-color: white; color: black;">0.7</div> -->
                            <cds-text [text]="action.temperature" [type]="'number'" (onChange)="updateSliderValue($event, 'temperature')" class="slider-input"></cds-text>
                        </div>
                    </div>
                </div>

                <div class="textarea-editor-wrapper">
                    <label class="title-label">System context</label>
                    <cds-textarea 
                        id="context" 
                        [textLimitBtn]="false" 
                        [emojiPikerBtn]="false" 
                        [setAttributeBtn]="false" 
                        [minRow]="1"
                        [maxRow]="3" 
                        [text]="action.context" 
                        [placeholder]="'You are an awesome assistant'"
                        (changeTextarea)="changeTextarea($event, 'context')">
                    </cds-textarea>
                </div>
            

            </div>
        </mat-expansion-panel>
    </mat-accordion>



    <!-- <div class="text-editor-wrapper">
        <div class="field-box">
            <label class="title-label">GPT Reply</label>
            <div class="value-wrp">
                <cds-textarea id="assignTo" 
                    [textLimitBtn]="false" 
                    [emojiPikerBtn]="false" 
                    [setAttributeBtn]="true"
                    [minRow]="1" 
                    [maxRow]="1" 
                    [readonly]="true" 
                    [text]="action.assignReplyTo"
                    (selectedAttribute)="onSelectedAttribute($event, 'assignReplyTo')"
                    (clearSelectedAttribute)="onSelectedAttribute($event, 'assignReplyTo')">
                </cds-textarea>
            </div>
        </div>
    </div>

    <div class="text-editor-wrapper">
        <div class="field-box">
            <label class="title-label">GPT Source</label>
            <div class="value-wrp">
                <cds-textarea id="assignTo" 
                    [textLimitBtn]="false"
                    [emojiPikerBtn]="false" 
                    [setAttributeBtn]="true"
                    [minRow]="1" 
                    [maxRow]="1" 
                    [readonly]="true" 
                    [text]="action.assignSourceTo"
                    (selectedAttribute)="onSelectedAttribute($event, 'assignSourceTo')"
                    (clearSelectedAttribute)="onSelectedAttribute($event, 'assignSourceTo')">
                </cds-textarea>
            </div>
        </div>
    </div> -->

</div>